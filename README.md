# ðŸ  Há»‡ thá»‘ng NhÃ  ThÃ´ng Minh Äiá»u khiá»ƒn MÃ¡y BÆ¡m NÆ°á»›c vÃ  Thiáº¿t bá»‹ Báº¿p

---

## ðŸŽ‰ Giá»›i thiá»‡u

Dá»± Ã¡n nÃ y Ä‘Æ°á»£c thá»±c hiá»‡n trong mÃ´n **Láº­p trÃ¬nh NhÃºng** táº¡i Há»c viá»‡n CÃ´ng nghá»‡ BÆ°u chÃ­nh Viá»…n thÃ´ng - CÆ¡ sá»Ÿ TP.HCM.

Há»‡ thá»‘ng nhÃ  thÃ´ng minh Ä‘iá»u khiá»ƒn **mÃ¡y bÆ¡m nÆ°á»›c**, **Ä‘Ã¨n báº¿p** vÃ  **quáº¡t thÃ´ng giÃ³**, tÃ­ch há»£p cáº£m biáº¿n vÃ  giao diá»‡n ngÆ°á»i dÃ¹ng thÃ¢n thiá»‡n, mang láº¡i sá»± tiá»‡n nghi vÃ  hiá»‡u quáº£ cho khÃ´ng gian báº¿p hiá»‡n Ä‘áº¡i.

Há»‡ thá»‘ng sá»­ dá»¥ng **vi Ä‘iá»u khiá»ƒn NUCLEO-STM32F429ZI**, cÃ¡c loáº¡i cáº£m biáº¿n (siÃªu Ã¢m, chuyá»ƒn Ä‘á»™ng, Ã¡nh sÃ¡ng), **LCD**, bÃ n phÃ­m vÃ  Ä‘Æ°á»£c láº­p trÃ¬nh nhÃºng Ä‘á»ƒ Ä‘áº£m báº£o hoáº¡t Ä‘á»™ng thÃ´ng minh vÃ  á»•n Ä‘á»‹nh.

### ThÃ´ng tin dá»± Ã¡n:

- **Sinh viÃªn:** Tráº§n Minh ThÆ°Æ¡ng  
- **MÃ£ sá»‘ sinh viÃªn:** N21DCVT101  
- **Lá»›p:** D21CQVTHI01-N  
- **Giáº£ng viÃªn:** ThS. Pháº¡m Quá»‘c Há»£p  
- **NgÃ y:** 10/05/2025

---

## ðŸŽ¯ Má»¥c tiÃªu Dá»± Ã¡n

- **Tá»± Ä‘á»™ng hÃ³a ðŸ¤–:** GiÃ¡m sÃ¡t vÃ  Ä‘iá»u khiá»ƒn thiáº¿t bá»‹ (mÃ¡y bÆ¡m, Ä‘Ã¨n, quáº¡t) dá»±a trÃªn cáº£m biáº¿n vÃ  lá»‹ch thá»i gian.  
- **Linh hoáº¡t ðŸ”„:** Há»— trá»£ cháº¿ Ä‘á»™ thá»§ cÃ´ng vÃ  tá»± Ä‘á»™ng, cÃ¹ng vá»›i cÃ i Ä‘áº·t lá»‹ch báº­t/táº¯t.  
- **Tráº£i nghiá»‡m ngÆ°á»i dÃ¹ng ðŸ–¥ï¸:** Giao diá»‡n LCD 20x4 trá»±c quan, nháº­p liá»‡u báº±ng bÃ n phÃ­m 4x4, cÃ³ báº£o máº­t máº­t kháº©u.  
- **Hiá»‡u quáº£ âš¡:** Váº­n hÃ nh á»•n Ä‘á»‹nh, tiáº¿t kiá»‡m nÄƒng lÆ°á»£ng.

---

## ðŸ“‹ TÃ­nh nÄƒng ChÃ­nh

### ðŸ”§ Cháº¿ Ä‘á»™ Thá»§ cÃ´ng ðŸ–ï¸

- Báº­t/táº¯t Ä‘Ã¨n, quáº¡t, mÃ¡y bÆ¡m qua nÃºt nháº¥n hoáº·c bÃ n phÃ­m (A/B/C).

### ðŸ¤– Cháº¿ Ä‘á»™ Tá»± Ä‘á»™ng

- MÃ¡y bÆ¡m hoáº¡t Ä‘á»™ng khi má»±c nÆ°á»›c tháº¥p (HC-SR04) vÃ  dá»«ng khi Ä‘áº§y.  
- ÄÃ¨n báº¿p báº­t khi cÃ³ chuyá»ƒn Ä‘á»™ng (PIR AM312) **vÃ ** Ã¡nh sÃ¡ng yáº¿u (LDR NVZ1).  
- Quáº¡t **luÃ´n báº­t** trong cháº¿ Ä‘á»™ tá»± Ä‘á»™ng.

### â° CÃ i Ä‘áº·t Thá»i gian

- Äáº·t lá»‹ch báº­t/táº¯t cho thiáº¿t bá»‹ (phÃ­m 1/2/3) vÃ  Ä‘áº·t giá» há»‡ thá»‘ng (phÃ­m 4).

### ðŸ”’ Báº£o máº­t

- **1111:** Thá»§ cÃ´ng  
- **2222:** Tá»± Ä‘á»™ng  
- **3333:** CÃ i Ä‘áº·t thá»i gian  
- **8888:** Má»Ÿ khÃ³a  
- **9999:** KhÃ³a há»‡ thá»‘ng

### ðŸ–¥ï¸ Giao diá»‡n

- LCD 20x4 hiá»ƒn thá»‹ menu, tráº¡ng thÃ¡i thiáº¿t bá»‹, vÃ  cáº£nh bÃ¡o lá»—i.

### ðŸš¨ Pháº£n há»“i

- LED (xanh/Ä‘á») vÃ  cÃ²i Ä‘á»ƒ cáº£nh bÃ¡o hoáº·c pháº£n há»“i tráº¡ng thÃ¡i.

---

## ðŸ› ï¸ ThÃ nh pháº§n Pháº§n cá»©ng

| Linh kiá»‡n            | MÃ´ táº£ |
|----------------------|-------|
| **NUCLEO-STM32F429ZI** | Vi Ä‘iá»u khiá»ƒn ARM Cortex-M4, 180 MHz, 2 MB Flash, 256 KB SRAM |
| **HC-SR04**          | Cáº£m biáº¿n siÃªu Ã¢m Ä‘o má»±c nÆ°á»›c (2â€“450 cm, Ä‘á»™ chÃ­nh xÃ¡c 3 mm) |
| **PIR AM312**        | Cáº£m biáº¿n phÃ¡t hiá»‡n chuyá»ƒn Ä‘á»™ng (3â€“5 m) |
| **LDR NVZ1**         | Cáº£m biáº¿n Ã¡nh sÃ¡ng Ä‘o cÆ°á»ng Ä‘á»™ sÃ¡ng |
| **BÃ n phÃ­m 4x4**     | 16 phÃ­m ma tráº­n (0â€“9, Aâ€“D, *, #) |
| **LCD 20x4**         | Hiá»ƒn thá»‹ tráº¡ng thÃ¡i (giao tiáº¿p 4-bit hoáº·c I2C) |
| **Relay 5V**         | Äiá»u khiá»ƒn thiáº¿t bá»‹ Ä‘iá»‡n (220V/10A) |
| **LED & CÃ²i**        | Hiá»ƒn thá»‹ tráº¡ng thÃ¡i, cáº£nh bÃ¡o lá»—i |

### ðŸ“¸ HÃ¬nh áº£nh Linh kiá»‡n

> (ChÃ¨n hÃ¬nh áº£nh thá»±c táº¿ vÃ o thÆ° má»¥c `media/` vÃ  thÃªm liÃªn káº¿t táº¡i Ä‘Ã¢y náº¿u cÃ³.)

---

## ðŸ”Œ Káº¿t ná»‘i ChÃ¢n

- **HC-SR04:** TRIG (PA6), ECHO (PA7)  
- **PIR AM312:** OUT (PA3)  
- **LDR NVZ1:** DO (PG9)  
- **BÃ n phÃ­m 4x4:**  
  - HÃ ng: PB3, PB5, PC7, PA15  
  - Cá»™t: PB12, PB13, PB15, PC6  
- **NÃºt nháº¥n:** PE9, PE11, PF14, PE13, PF15  
- **Relay:** PF2 (mÃ¡y bÆ¡m), PE6 (quáº¡t)  
- **LED:** PG14, PB6, PB2, PD15, PF12  
- **CÃ²i:** PE10  
- **LCD:** GPIO hoáº·c I2C qua PCF8574 (SDA/SCL)

---

## ðŸ“Š Kiáº¿n trÃºc Há»‡ thá»‘ng

Vi Ä‘iá»u khiá»ƒn **STM32F429ZI** lÃ  trung tÃ¢m Ä‘iá»u khiá»ƒn:

### Giao thá»©c Truyá»n thÃ´ng:

- **GPIO ðŸ“¡:** Äiá»u khiá»ƒn cáº£m biáº¿n, relay, LED, nÃºt nháº¥n  
- **Keypad âŒ¨ï¸:** QuÃ©t bÃ n phÃ­m 4x4  
- **HC-SR04 â±ï¸:** Äo khoáº£ng cÃ¡ch báº±ng TRIG/ECHO  
- **LCD ðŸ–¥ï¸:** Giao tiáº¿p song song hoáº·c I2C  
- **Ngáº¯t âš¡:** Pháº£n há»“i sá»± kiá»‡n nhanh tá»« cáº£m biáº¿n/nÃºt nháº¥n

---

## ðŸ’» Chi tiáº¿t Pháº§n má»m

### MÃ´i trÆ°á»ng PhÃ¡t triá»ƒn

- **IDE:** Visual Studio Code + PlatformIO  
- **Framework:** Arduino cho STM32  
- **NgÃ´n ngá»¯:** C/C++  
- **ThÆ° viá»‡n:**  
  - `LiquidCrystal_I2C`  
  - STM32 HAL/LL

### Kiáº¿n trÃºc Pháº§n má»m

- **FSM ðŸ§ :** Quáº£n lÃ½ cÃ¡c cháº¿ Ä‘á»™ (Thá»§ cÃ´ng, Tá»± Ä‘á»™ng, CÃ i Ä‘áº·t thá»i gian)  
- **Interrupt-Driven âš¡:** Xá»­ lÃ½ ngáº¯t tá»« nÃºt vÃ  cáº£m biáº¿n  
- **Module hÃ³a ðŸ§©:** TÃ¡ch cÃ¡c chá»©c nÄƒng thÃ nh module  
- **Soft-RTC â²ï¸:** Sá»­ dá»¥ng `millis()` vÃ  `micros()`  
- **Debounce ðŸ”§:** Chá»‘ng nhiá»…u nÃºt nháº¥n vÃ  bÃ n phÃ­m

---

## ðŸ“ Cáº¥u trÃºc ThÆ° má»¥c

â”œâ”€â”€ include/
â”‚ â”œâ”€â”€ actuators.h
â”‚ â”œâ”€â”€ buttons.h
â”‚ â”œâ”€â”€ display.h
â”‚ â”œâ”€â”€ keypad.h
â”‚ â”œâ”€â”€ modes.h
â”‚ â”œâ”€â”€ security.h
â”‚ â”œâ”€â”€ sensors.h
â”‚ â”œâ”€â”€ time_management.h
â”‚ â”œâ”€â”€ utils.h
â”œâ”€â”€ src/
â”‚ â”œâ”€â”€ main.cpp
â”‚ â”œâ”€â”€ actuators.cpp
â”‚ â”œâ”€â”€ buttons.cpp
â”‚ â”œâ”€â”€ display.cpp
â”‚ â”œâ”€â”€ keypad.cpp
â”‚ â”œâ”€â”€ modes.cpp
â”‚ â”œâ”€â”€ security.cpp
â”‚ â”œâ”€â”€ sensors.cpp
â”‚ â”œâ”€â”€ time_management.cpp
â”‚ â”œâ”€â”€ utils.cpp
â”œâ”€â”€ platformio.ini
â”œâ”€â”€ README.md
â”œâ”€â”€ media/
â”‚ â”œâ”€â”€ image23.png
â”‚ â”œâ”€â”€ image24.png

---

## ðŸš€ HÆ°á»›ng dáº«n CÃ i Ä‘áº·t vÃ  Sá»­ dá»¥ng

### YÃªu cáº§u

**Pháº§n cá»©ng:**  
- NUCLEO-STM32F429ZI  
- HC-SR04, PIR AM312, LDR NVZ1  
- BÃ n phÃ­m 4x4, LCD 20x4, Relay  
- LED, CÃ²i, nguá»“n 5V/12V

**Pháº§n má»m:**  
- Visual Studio Code  
- PlatformIO  
- Driver ST-LINK

### CÃ¡c bÆ°á»›c CÃ i Ä‘áº·t

1. **Clone repo ðŸ“¥:**

git clone https://github.com/MinhThuongTMT/Full_Code-Project-LTN.git
cd Full_Code-Project-LTN
Má»Ÿ trong VS Code ðŸ’»:

Má»Ÿ thÆ° má»¥c dá»± Ã¡n

PlatformIO tá»± nháº­n file platformio.ini

Káº¿t ná»‘i Pháº§n cá»©ng ðŸ”Œ:

Ná»‘i thiáº¿t bá»‹ theo sÆ¡ Ä‘á»“ chÃ¢n

Cáº¥p nguá»“n 5V cho vi Ä‘iá»u khiá»ƒn/cáº£m biáº¿n, 12V cho relay

BiÃªn dá»‹ch & Upload âš™ï¸:

Má»Ÿ báº£ng PlatformIO

Nháº¥n Build Ä‘á»ƒ biÃªn dá»‹ch

Nháº¥n Upload Ä‘á»ƒ náº¡p mÃ£

Kiá»ƒm tra ðŸ§ª:

LCD hiá»ƒn thá»‹ menu chÃ­nh

Thá»­ Ä‘iá»u khiá»ƒn báº±ng nÃºt vÃ  bÃ n phÃ­m

## ðŸ” HÆ°á»›ng dáº«n Sá»­ dá»¥ng
HÆ°á»›ng dáº«n Sá»­ dá»¥ng

Cháº¿ Ä‘á»™ Há»‡ thá»‘ng





Thá»§ cÃ´ng (Máº­t kháº©u: 1111 hoáº·c nÃºt BUTTON_MANUAL):





DÃ¹ng nÃºt hoáº·c phÃ­m A (Ä‘Ã¨n), B (quáº¡t), C (mÃ¡y bÆ¡m) Ä‘á»ƒ báº­t/táº¯t.



LED hiá»ƒn thá»‹ tráº¡ng thÃ¡i (xanh: Báº¬T, Ä‘á»: Táº®T).



Tá»± Ä‘á»™ng (Máº­t kháº©u: 2222 hoáº·c nÃºt BUTTON_AUTO):





MÃ¡y bÆ¡m báº­t náº¿u má»±c nÆ°á»›c > 20 cm, táº¯t náº¿u < 10 cm.



ÄÃ¨n báº­t khi cÃ³ chuyá»ƒn Ä‘á»™ng vÃ  Ã¡nh sÃ¡ng yáº¿u.



Quáº¡t luÃ´n báº­t.



CÃ i Ä‘áº·t Thá»i gian (Máº­t kháº©u: 3333 hoáº·c nÃºt BUTTON_SETTING):





PhÃ­m 4: Äáº·t giá» hiá»‡n táº¡i (hh:mm, xÃ¡c nháº­n báº±ng #).



PhÃ­m 1/2/3: Äáº·t lá»‹ch Báº¬T/Táº®T cho Ä‘Ã¨n/quáº¡t/mÃ¡y bÆ¡m.



PhÃ­m A: Xem tráº¡ng thÃ¡i thiáº¿t bá»‹ (Báº¬T/Táº®T hoáº·c "ChÆ°a cÃ i").



KhÃ³a/Má»Ÿ Há»‡ thá»‘ng:





Tá»« menu chÃ­nh (phÃ­m *), chá»n "2. Khoa he thong".



Nháº­p 8888 (má»Ÿ) hoáº·c 9999 (khÃ³a), xÃ¡c nháº­n báº±ng #.



Há»‡ thá»‘ng khÃ³a vÃ´ hiá»‡u hÃ³a nÃºt nháº¥n.

Äiá»u hÆ°á»›ng BÃ n phÃ­m







PhÃ­m



Chá»©c nÄƒng





*



Má»Ÿ menu chÃ­nh tá»« mÃ n hÃ¬nh Home





#



XÃ¡c nháº­n nháº­p liá»‡u (máº­t kháº©u, thá»i gian)





A



Báº­t/táº¯t Ä‘Ã¨n (Thá»§ cÃ´ng) hoáº·c xem tráº¡ng thÃ¡i





B



Báº­t/táº¯t quáº¡t (Thá»§ cÃ´ng)





C



Báº­t/táº¯t mÃ¡y bÆ¡m (Thá»§ cÃ´ng)





D



XÃ³a kÃ½ tá»± cuá»‘i trong nháº­p liá»‡u





0â€“9



Nháº­p sá»‘ cho máº­t kháº©u, thá»i gian, má»±c nÆ°á»›c

VÃ­ dá»¥ Sá»­ dá»¥ng





Khá»Ÿi Ä‘á»™ng ðŸš€:





Báº­t nguá»“n; LCD hiá»ƒn thá»‹ mÃ n hÃ¬nh chÃ­nh.



VÃ o Cháº¿ Ä‘á»™ Thá»§ cÃ´ng ðŸ–ï¸:





Nháº¥n *, chá»n "1. Chon che do", nháº­p 1111, nháº¥n #.



Nháº¥n A Ä‘á»ƒ báº­t/táº¯t Ä‘Ã¨n; LCD hiá»ƒn thá»‹ "Bat den" hoáº·c "Tat den".



CÃ i Má»±c NÆ°á»›c ðŸ’§:





Tá»« menu, chá»n "3. Cai dat muc nuoc".



Nháº­p má»±c nÆ°á»›c báº­t (vÃ­ dá»¥: 20 cm), nháº¥n #, sau Ä‘Ã³ má»±c táº¯t (10 cm), nháº¥n #.



KhÃ³a Há»‡ thá»‘ng ðŸ”’:





Tá»« menu, chá»n "2. Khoa he thong", nháº­p 9999, nháº¥n #.



LCD hiá»ƒn thá»‹ "System Locked".



ðŸ” Háº¡n cháº¿ Dá»± Ã¡n





Giá»›i háº¡n Thiáº¿t bá»‹ ðŸš«: Chá»‰ Ä‘iá»u khiá»ƒn mÃ¡y bÆ¡m, Ä‘Ã¨n, quáº¡t; chÆ°a há»— trá»£ thiáº¿t bá»‹ khÃ¡c (báº¿p tá»«, tá»§ láº¡nh).



Pháº§n cá»©ng âš ï¸: Cáº£m biáº¿n dá»… bá»‹ nhiá»…u bá»Ÿi bá»¥i, nhiá»‡t, Ã¡nh sÃ¡ng máº¡nh.



Giao diá»‡n ðŸ“º: LCD 20x4 chá»‰ hiá»ƒn thá»‹ kÃ½ tá»±, thiáº¿u Ä‘á»“ há»a hoáº·c Ä‘a ngÃ´n ngá»¯.



Káº¿t ná»‘i ðŸŒ: KhÃ´ng há»— trá»£ Internet, khÃ´ng Ä‘iá»u khiá»ƒn tá»« xa.



Thá»i gian â³: Soft-RTC dá»… trÃ´i giá» náº¿u máº¥t Ä‘iá»‡n.



Báº£o máº­t ðŸ”: Máº­t kháº©u cá»‘ Ä‘á»‹nh, khÃ´ng thay Ä‘á»•i Ä‘á»™ng.



ðŸŒŸ Cáº£i tiáº¿n TÆ°Æ¡ng Lai





Káº¿t ná»‘i IoT ðŸ“±: ThÃªm Wi-Fi (ESP32) Ä‘á»ƒ Ä‘iá»u khiá»ƒn qua á»©ng dá»¥ng/web.



Cáº£m biáº¿n NÃ¢ng cao ðŸŒ¡ï¸: TÃ­ch há»£p cáº£m biáº¿n nhiá»‡t Ä‘á»™, Ä‘á»™ áº©m (DHT22) hoáº·c khÃ­ gas (MQ-2).



Giao diá»‡n Hiá»‡n Ä‘áº¡i ðŸ–¼ï¸: Sá»­ dá»¥ng mÃ n hÃ¬nh cáº£m á»©ng TFT hoáº·c Ä‘iá»u khiá»ƒn báº±ng giá»ng nÃ³i.



Tiáº¿t kiá»‡m NÄƒng lÆ°á»£ng âš¡: ThÃªm cháº¿ Ä‘á»™ ngá»§ vÃ  giÃ¡m sÃ¡t tiÃªu thá»¥ Ä‘iá»‡n.



Module hÃ³a ðŸ§©: Thiáº¿t káº¿ pháº§n cá»©ng/pháº§n má»m plug-and-play.



Báº£o máº­t ðŸ”’: Há»— trá»£ máº­t kháº©u Ä‘á»™ng vÃ  mÃ£ hÃ³a dá»¯ liá»‡u.



ðŸ“š TÃ i liá»‡u Tham kháº£o





Nguyá»…n VÄƒn An & Pháº¡m Thá»‹ Há»“ng Nhung, "Thiáº¿t káº¿ há»‡ thá»‘ng Ä‘iá»u khiá»ƒn tá»± Ä‘á»™ng mÃ¡y bÆ¡m nÆ°á»›c sá»­ dá»¥ng vi Ä‘iá»u khiá»ƒn STM32," PTIT, 2022.



Tráº§n Quá»‘c HÃ¹ng, "á»¨ng dá»¥ng cáº£m biáº¿n siÃªu Ã¢m HC-SR04 trong Ä‘o lÆ°á»ng vÃ  Ä‘iá»u khiá»ƒn má»±c nÆ°á»›c," HUI, 2021.



Pháº¡m VÄƒn Minh & LÃª Thá»‹ Thu HÃ , "XÃ¢y dá»±ng há»‡ thá»‘ng nhÃ  thÃ´ng minh dá»±a trÃªn giao thá»©c I2C vÃ  vi Ä‘iá»u khiá»ƒn STM32," HUST, 2023.



STMicroelectronics, STM32F429ZI Datasheet, 2023.



PlatformIO Documentation, 2023.



ðŸ¤ ÄÃ³ng gÃ³p

ChÃ o má»«ng má»i Ä‘Ã³ng gÃ³p! Äá»ƒ tham gia:





Fork kho mÃ£.



Táº¡o nhÃ¡nh má»›i (git checkout -b ten-nhanh).



Thá»±c hiá»‡n thay Ä‘á»•i vÃ  commit (git commit -m "MÃ´ táº£ thay Ä‘á»•i").



Äáº©y lÃªn nhÃ¡nh (git push origin ten-nhanh).



Má»Ÿ Pull Request.

Vui lÃ²ng Ä‘áº£m báº£o mÃ£ tuÃ¢n theo phong cÃ¡ch cá»§a dá»± Ã¡n vÃ  cÃ³ tÃ i liá»‡u Ä‘áº§y Ä‘á»§.

